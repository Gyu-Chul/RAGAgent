[
  {
    "type": "module",
    "name": "",
    "start_line": 1,
    "end_line": 2,
    "code": "from flask import Blueprint, render_template, request, redirect, url_for, flash, make_response, g\nfrom utils.auth_utils import validate_user, create_session, validate_session, delete_session",
    "file_path": "C:\\Users\\su9ki\\Desktop\\git-ai\\git-agent\\repository\\awstest\\loginPage.py"
  },
  {
    "type": "script",
    "name": "",
    "start_line": 4,
    "end_line": 4,
    "code": "loginPage_bp = Blueprint(\"login\", __name__)",
    "file_path": "C:\\Users\\su9ki\\Desktop\\git-ai\\git-agent\\repository\\awstest\\loginPage.py"
  },
  {
    "type": "function",
    "name": "load_session",
    "start_line": 8,
    "end_line": 23,
    "code": "def load_session():\n    # 클라이언트 쿠키에서 세션 ID를 가져와 g 객체에 저장\n    session_id = request.cookies.get(\"session_id\")\n    # get_active_sessions()\n    session_valid, response = validate_session(session_id)\n\n    if response:\n        flash(\"세션이 만료되었습니다.\", \"danger\")\n        return response\n\n    if session_valid:\n        flash(\"로그아웃 완료!\", \"success\")\n        # return redirect(url_for(\"login.login\"))\n        return\n\n    flash(\"이미 로그아웃 상태입니다.\", \"info\")",
    "file_path": "C:\\Users\\su9ki\\Desktop\\git-ai\\git-agent\\repository\\awstest\\loginPage.py"
  },
  {
    "type": "function",
    "name": "login",
    "start_line": 33,
    "end_line": 53,
    "code": "def login():\n    if request.method == \"POST\":\n        # 폼에서 사용자 입력 데이터 가져오기\n        user_id = request.form.get(\"user_id\")\n        password = request.form.get(\"password\")\n\n        # 사용자 인증\n        if validate_user(user_id, password):\n            # 세션 생성\n            session_id = create_session(user_id)\n\n            # 쿠키에 세션 ID 설정\n            response = make_response(redirect(url_for(\"upload.upload_image\")))\n            response.set_cookie(\"session_id\", session_id, httponly=True, secure=True)\n\n            flash(\"로그인 성공!\", \"success\")\n            return response\n        else:\n            flash(\"아이디 또는 비밀번호가 올바르지 않습니다.\", \"danger\")\n\n    return render_template(\"login.html\")",
    "file_path": "C:\\Users\\su9ki\\Desktop\\git-ai\\git-agent\\repository\\awstest\\loginPage.py"
  },
  {
    "type": "function",
    "name": "logout",
    "start_line": 57,
    "end_line": 78,
    "code": "def logout():\n    # 클라이언트 쿠키에서 세션 ID 가져오기\n    session_id = request.cookies.get(\"session_id\")\n\n    if session_id:\n        if validate_session(session_id):\n            # 세션 삭제\n            delete_session(session_id)\n\n            # 쿠키에서 세션 ID 삭제\n            response = make_response(redirect(url_for(\"login.login\")))\n            response.delete_cookie(\"session_id\")\n\n            flash(\"로그아웃 완료!\", \"success\")\n            return response\n        else:  # 사실 어차피 일어날 수 없는 상황\n            flash(\"세션에는 넌 이미 없는 존재란다\", \"danger\")\n    else:\n        flash(\"쿠키가 비었는데 어떻게 들어와있니?\", \"danger\")\n\n    # 로그아웃 실패 시 로그인 페이지로 리다이렉트\n    return redirect(url_for(\"login.login\"))",
    "file_path": "C:\\Users\\su9ki\\Desktop\\git-ai\\git-agent\\repository\\awstest\\loginPage.py"
  }
]